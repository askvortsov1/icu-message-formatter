"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var r=e(require("@babel/runtime/helpers/slicedToArray")),t=e(require("@babel/runtime/helpers/classCallCheck")),n=e(require("@babel/runtime/helpers/createClass")),s=e(require("@babel/runtime/helpers/defineProperty")),i=require("@ultraq/array-utils"),a=require("@ultraq/function-utils");function l(e){for(var r=function(e){return/\s/.test(e)},t=[],n={},s=0,i=null,a=!1,l=0;l<e.length;){if(a&&(r(e[l])||"{"===e[l]))a=!1,i=e.slice(s,l),"{"===e[l]&&l--;else if(!a&&!r(e[l])){var o="{"===e[l];if(i&&o){var u=c(e,l);if(-1===u)throw new Error('Unbalanced curly braces in string: "'.concat(e,'"'));n[i]=e.slice(l+1,u),l=u,i=null}else i&&(t.push(i),i=null),a=!0,s=l}l++}return a&&(i=e.slice(s)),i&&t.push(i),{args:t,cases:n}}function o(e,r,t){for(var n,s=[],i=0;i<e.length;i++){var a=e[i];if("string"==typeof a){for(var l=0,c=null,f=!1,h=!1;l<a.length;){if(f||"<"!==a[l]){if(f&&">"===a[l]){var p=a.slice(c+1,l),v=u(e,p,i,l);if(!v)throw new Error("Unbalanced tags: no closing tag found for <".concat(p,">"));var g=v.segmentIndex===i,d=e[v.segmentIndex],b=[];if(g)b.push(a.slice(l+1,v.segmentStart));else{b.push(a.slice(l+1));for(var m=i+1;m<v.segmentIndex;m++)b.push(e[m]);b.push(d.slice(0,v.segmentStart))}s.push(a.slice(0,c)),s.push(t(p,r,o(b.filter((function(e){return""!==e})),r,t))),e.splice(v.segmentIndex+1,0,d.slice(v.segmentEnd+1)),h=!0,i=v.segmentIndex;break}f&&(n=a[l],!/[a-zA-Z-_]/.test(n))&&(c=null,f=!1)}else c=l,f=!0;l++}h||s.push(a)}else s.push(a)}return s.filter((function(e){return""!==e}))}function u(e,r,t,n){for(var s,i=1,a=t;a<e.length;a++){var l=e[a];if("string"==typeof l)for(var o=!1,u=null,c=!1,f=a===t?n:0;f<l.length;f++)if(c||"<"!==l[f])if(c&&">"===l[f]){if(l.slice(u+1+o,f)===r&&(o?i--:i++,0===i))return{segmentIndex:a,segmentStart:u,segmentEnd:f};o=!1,u=null,c=!1}else c&&(s=l[f],!/[a-zA-Z-_]/.test(s))&&(o=!1,u=null,c=!1);else u=f,c=!0,"/"===l[f+1]&&(o=!0,f++)}}function c(e,r){for(var t=0,n=r+1;n<e.length;n++){var s=e.charAt(n);if("}"===s){if(0===t)return n;t--}else"{"===s&&t++}return-1}function f(e){return h(e.slice(1,-1),",",3)}function h(e,r,t){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(!e)return n;if(1===t)return n.push(e),n;var s=e.indexOf(r);if(-1===s)return n.push(e),n;var i=e.substring(0,s).trim(),a=e.substring(s+r.length+1).trim();return n.push(i),h(a,r,t-1,n)}function p(e,r,t){return"<".concat(e,">").concat(t,"</").concat(e,">")}var v=function(){function e(r){var n=this,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t(this,e),s(this,"format",a.memoize((function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.flatten(n.process(e,r)).join("")}))),this.locale=r,this.typeHandlers=l,this.richHandler=o||p}return n(e,[{key:"rich",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=i.flatten(this.process(e,r));return o(t,r,this.richHandler)}},{key:"process",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return[];var n=e.indexOf("{");if(-1!==n){var s=c(e,n);if(-1===s)throw new Error('Unbalanced curly braces in string: "'.concat(e,'"'));var i=e.substring(n,s+1);if(i){var a=[],l=e.substring(0,n);l&&a.push(l);var o=f(i),u=r(o,3),h=u[0],p=u[1],v=u[2],g=t[h];null==g&&(g="");var d=p&&this.typeHandlers[p];a.push(d?d(g,v,this.locale,t,this.process.bind(this)):g);var b=e.substring(s+1);return b&&a.push(this.process(b,t)),a}}return[e]}}]),e}();function g(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?g(Object(t),!0).forEach((function(r){s(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):g(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var b=0;function m(e,r){for(var t=0,n="",s=0,i={};t<e.length;){if("#"!==e[t]||s)n+=e[t];else{var a="__hashToken".concat(b++);n+="{".concat(a,", number}"),i[a]=r}"{"===e[t]?s++:"}"===e[t]&&s--,t++}return{caseBody:n,numberValues:i}}exports.MessageFormatter=v,exports.findClosingBracket=c,exports.parseCases=l,exports.pluralTypeHandler=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,s=l(r),i=s.args,a=s.cases,o=parseInt(e);i.forEach((function(e){e.startsWith("offset:")&&(o-=parseInt(e.slice("offset:".length)))}));var u=[];1===o&&u.push("one"),u.push("=".concat(o),"other");for(var c=0;c<u.length;c++){var f=u[c];if(f in a){var h=m(a[f],o),p=h.caseBody,v=h.numberValues;return n(p,d(d({},t),v))}}return e},exports.selectTypeHandler=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,s=l(r),i=s.cases;return e in i?n(i[e],t):"other"in i?n(i.other,t):e},exports.splitFormattedArgument=f;
